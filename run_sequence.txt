cd ..
export TWOBYTWO_SIM=$PWD/2x2_sim
cd $TWOBYTWO_SIM
export ARCUBE_OUTDIR_BASE=$SCRATCH/2x2tut_outD
export ARCUBE_LOGDIR_BASE=$SCRATCH/2x2tut_logD
mkdir -p $ARCUBE_OUTDIR_BASE $ARCUBE_LOGDIR_BASE

cd $TWOBYTWO_SIM/run-genie

export ARCUBE_RUNTIME=SHIFTER
export ARCUBE_CONTAINER=mjkramer/sim2x2:genie_edep.3_04_00.20230912
export ARCUBE_DET_LOCATION=MiniRun5-Nu
export ARCUBE_DK2NU_DIR=/dvs_ro/cfs/cdirs/dune/users/mkramer/2x2EventGeneration/NuMI_dk2nu/newtarget-200kA_20220409
export ARCUBE_EXPOSURE=1E15
export ARCUBE_GEOM=geometry/Merged2x2MINERvA_v4/Merged2x2MINERvA_v4_noRock.gdml
export ARCUBE_TUNE=AR23_20i_00_000
export ARCUBE_RUN_OFFSET=0
export ARCUBE_XSEC_FILE=/dvs_ro/cfs/cdirs/dune/users/mkramer/2x2EventGeneration/inputs/NuMI/genie_xsec-3.04.00-noarch-AR2320i00000-k250-e1000/v3_04_00/NULL/AR2320i00000-k250-e1000/data/gxspl-NUsmall.xml
export ARCUBE_OUT_NAME=Tutorial.genie.nu

#ARCUBE_INDEX=1 ./run_genie.sh 

#for i in $(seq 0 9); do
#    ARCUBE_INDEX=$i ./run_genie.sh &
#done

#wait

cd $TWOBYTWO_SIM/run-edep-sim

export ARCUBE_RUNTIME=SHIFTER
export ARCUBE_CONTAINER=mjkramer/sim2x2:ndlar011
export ARCUBE_GENIE_NAME=Tutorial.genie.nu
export ARCUBE_EDEP_MAC=macros/2x2_beam.mac
export ARCUBE_GEOM_EDEP=geometry/Merged2x2MINERvA_v4/Merged2x2MINERvA_v4_noRock.gdml
export ARCUBE_RUN_OFFSET=0
export ARCUBE_OUT_NAME=Tutorial.edep.nu

#ARCUBE_INDEX=1 ./run_edep_sim.sh

for i in $(seq 0 9); do
    ARCUBE_INDEX=$i ./run_edep_sim.sh &
done

wait

export ARCUBE_INDEX=1
export ARCUBE_HADD_FACTOR=1


cd $TWOBYTWO_SIM/run-convert2h5
export ARCUBE_RUNTIME=SHIFTER
export ARCUBE_CONTAINER=mjkramer/sim2x2:ndlar011

export ARCUBE_ACTIVE_VOLUME=volTPCActive
export ARCUBE_INDEX=0

for filename in /pscratch/sd/s/sthoma31/2x2tut_outD/run-edep-sim/Tutorial.edep.nu/EDEPSIM/0000000/Tutorial.edep.nu.000000*.root; do    
    export CURRENT_FILE=$filename
    export ARCUBE_OUT_NAME=Tutorial.convert2h5
    ./run_convert2h5.sh
    ARCUBE_INDEX=$((ARCUBE_INDEX+1))
done

top
